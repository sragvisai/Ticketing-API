{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.retryWhen = void 0;\n\nvar Subject_1 = require(\"../Subject\");\n\nvar lift_1 = require(\"../util/lift\");\n\nvar OperatorSubscriber_1 = require(\"./OperatorSubscriber\");\n\nfunction retryWhen(notifier) {\n  return lift_1.operate(function (source, subscriber) {\n    var innerSub;\n    var syncResub = false;\n    var errors$;\n\n    var subscribeForRetryWhen = function () {\n      innerSub = source.subscribe(new OperatorSubscriber_1.OperatorSubscriber(subscriber, undefined, undefined, function (err) {\n        if (!errors$) {\n          errors$ = new Subject_1.Subject();\n          notifier(errors$).subscribe(new OperatorSubscriber_1.OperatorSubscriber(subscriber, function () {\n            return innerSub ? subscribeForRetryWhen() : syncResub = true;\n          }));\n        }\n\n        if (errors$) {\n          errors$.next(err);\n        }\n      }));\n\n      if (syncResub) {\n        innerSub.unsubscribe();\n        innerSub = null;\n        syncResub = false;\n        subscribeForRetryWhen();\n      }\n    };\n\n    subscribeForRetryWhen();\n  });\n}\n\nexports.retryWhen = retryWhen;","map":{"version":3,"sources":["../../../../src/internal/operators/retryWhen.ts"],"names":[],"mappings":";;;;;;;AACA,IAAA,SAAA,GAAA,OAAA,CAAA,YAAA,CAAA;;AAIA,IAAA,MAAA,GAAA,OAAA,CAAA,cAAA,CAAA;;AACA,IAAA,oBAAA,GAAA,OAAA,CAAA,sBAAA,CAAA;;AAsDA,SAAgB,SAAhB,CAA6B,QAA7B,EAAmF;AACjF,SAAO,MAAA,CAAA,OAAA,CAAQ,UAAC,MAAD,EAAS,UAAT,EAAmB;AAChC,QAAI,QAAJ;AACA,QAAI,SAAS,GAAG,KAAhB;AACA,QAAI,OAAJ;;AAEA,QAAM,qBAAqB,GAAG,YAAA;AAC5B,MAAA,QAAQ,GAAG,MAAM,CAAC,SAAP,CACT,IAAI,oBAAA,CAAA,kBAAJ,CAAuB,UAAvB,EAAmC,SAAnC,EAA8C,SAA9C,EAAyD,UAAC,GAAD,EAAI;AAC3D,YAAI,CAAC,OAAL,EAAc;AACZ,UAAA,OAAO,GAAG,IAAI,SAAA,CAAA,OAAJ,EAAV;AACA,UAAA,QAAQ,CAAC,OAAD,CAAR,CAAkB,SAAlB,CACE,IAAI,oBAAA,CAAA,kBAAJ,CAAuB,UAAvB,EAAmC,YAAA;AAMjC,mBAAA,QAAQ,GAAG,qBAAqB,EAAxB,GAA8B,SAAS,GAAG,IAAlD;AAAuD,WANzD,CADF;AAUD;;AACD,YAAI,OAAJ,EAAa;AAEX,UAAA,OAAO,CAAC,IAAR,CAAa,GAAb;AACD;AACF,OAlBD,CADS,CAAX;;AAsBA,UAAI,SAAJ,EAAe;AAKb,QAAA,QAAQ,CAAC,WAAT;AACA,QAAA,QAAQ,GAAG,IAAX;AAEA,QAAA,SAAS,GAAG,KAAZ;AAEA,QAAA,qBAAqB;AACtB;AACF,KAnCD;;AAsCA,IAAA,qBAAqB;AACtB,GA5CM,CAAP;AA6CD;;AA9CD,OAAA,CAAA,SAAA,GAAA,SAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.retryWhen = void 0;\nvar Subject_1 = require(\"../Subject\");\nvar lift_1 = require(\"../util/lift\");\nvar OperatorSubscriber_1 = require(\"./OperatorSubscriber\");\nfunction retryWhen(notifier) {\n    return lift_1.operate(function (source, subscriber) {\n        var innerSub;\n        var syncResub = false;\n        var errors$;\n        var subscribeForRetryWhen = function () {\n            innerSub = source.subscribe(new OperatorSubscriber_1.OperatorSubscriber(subscriber, undefined, undefined, function (err) {\n                if (!errors$) {\n                    errors$ = new Subject_1.Subject();\n                    notifier(errors$).subscribe(new OperatorSubscriber_1.OperatorSubscriber(subscriber, function () {\n                        return innerSub ? subscribeForRetryWhen() : (syncResub = true);\n                    }));\n                }\n                if (errors$) {\n                    errors$.next(err);\n                }\n            }));\n            if (syncResub) {\n                innerSub.unsubscribe();\n                innerSub = null;\n                syncResub = false;\n                subscribeForRetryWhen();\n            }\n        };\n        subscribeForRetryWhen();\n    });\n}\nexports.retryWhen = retryWhen;\n//# sourceMappingURL=retryWhen.js.map"]},"metadata":{},"sourceType":"script"}