{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.combineLatestInit = exports.combineLatest = void 0;\n\nvar Observable_1 = require(\"../Observable\");\n\nvar argsArgArrayOrObject_1 = require(\"../util/argsArgArrayOrObject\");\n\nvar from_1 = require(\"./from\");\n\nvar identity_1 = require(\"../util/identity\");\n\nvar mapOneOrManyArgs_1 = require(\"../util/mapOneOrManyArgs\");\n\nvar args_1 = require(\"../util/args\");\n\nvar createObject_1 = require(\"../util/createObject\");\n\nvar OperatorSubscriber_1 = require(\"../operators/OperatorSubscriber\");\n\nvar executeSchedule_1 = require(\"../util/executeSchedule\");\n\nfunction combineLatest() {\n  var args = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    args[_i] = arguments[_i];\n  }\n\n  var scheduler = args_1.popScheduler(args);\n  var resultSelector = args_1.popResultSelector(args);\n\n  var _a = argsArgArrayOrObject_1.argsArgArrayOrObject(args),\n      observables = _a.args,\n      keys = _a.keys;\n\n  if (observables.length === 0) {\n    return from_1.from([], scheduler);\n  }\n\n  var result = new Observable_1.Observable(combineLatestInit(observables, scheduler, keys ? function (values) {\n    return createObject_1.createObject(keys, values);\n  } : identity_1.identity));\n  return resultSelector ? result.pipe(mapOneOrManyArgs_1.mapOneOrManyArgs(resultSelector)) : result;\n}\n\nexports.combineLatest = combineLatest;\n\nfunction combineLatestInit(observables, scheduler, valueTransform) {\n  if (valueTransform === void 0) {\n    valueTransform = identity_1.identity;\n  }\n\n  return function (subscriber) {\n    maybeSchedule(scheduler, function () {\n      var length = observables.length;\n      var values = new Array(length);\n      var active = length;\n      var remainingFirstValues = length;\n\n      var _loop_1 = function (i) {\n        maybeSchedule(scheduler, function () {\n          var source = from_1.from(observables[i], scheduler);\n          var hasFirstValue = false;\n          source.subscribe(new OperatorSubscriber_1.OperatorSubscriber(subscriber, function (value) {\n            values[i] = value;\n\n            if (!hasFirstValue) {\n              hasFirstValue = true;\n              remainingFirstValues--;\n            }\n\n            if (!remainingFirstValues) {\n              subscriber.next(valueTransform(values.slice()));\n            }\n          }, function () {\n            if (! --active) {\n              subscriber.complete();\n            }\n          }));\n        }, subscriber);\n      };\n\n      for (var i = 0; i < length; i++) {\n        _loop_1(i);\n      }\n    }, subscriber);\n  };\n}\n\nexports.combineLatestInit = combineLatestInit;\n\nfunction maybeSchedule(scheduler, execute, subscription) {\n  if (scheduler) {\n    executeSchedule_1.executeSchedule(subscription, scheduler, execute);\n  } else {\n    execute();\n  }\n}","map":{"version":3,"sources":["../../../../src/internal/observable/combineLatest.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.combineLatestInit = exports.combineLatest = void 0;\nvar Observable_1 = require(\"../Observable\");\nvar argsArgArrayOrObject_1 = require(\"../util/argsArgArrayOrObject\");\nvar from_1 = require(\"./from\");\nvar identity_1 = require(\"../util/identity\");\nvar mapOneOrManyArgs_1 = require(\"../util/mapOneOrManyArgs\");\nvar args_1 = require(\"../util/args\");\nvar createObject_1 = require(\"../util/createObject\");\nvar OperatorSubscriber_1 = require(\"../operators/OperatorSubscriber\");\nvar executeSchedule_1 = require(\"../util/executeSchedule\");\nfunction combineLatest() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var scheduler = args_1.popScheduler(args);\n    var resultSelector = args_1.popResultSelector(args);\n    var _a = argsArgArrayOrObject_1.argsArgArrayOrObject(args), observables = _a.args, keys = _a.keys;\n    if (observables.length === 0) {\n        return from_1.from([], scheduler);\n    }\n    var result = new Observable_1.Observable(combineLatestInit(observables, scheduler, keys\n        ?\n            function (values) { return createObject_1.createObject(keys, values); }\n        :\n            identity_1.identity));\n    return resultSelector ? result.pipe(mapOneOrManyArgs_1.mapOneOrManyArgs(resultSelector)) : result;\n}\nexports.combineLatest = combineLatest;\nfunction combineLatestInit(observables, scheduler, valueTransform) {\n    if (valueTransform === void 0) { valueTransform = identity_1.identity; }\n    return function (subscriber) {\n        maybeSchedule(scheduler, function () {\n            var length = observables.length;\n            var values = new Array(length);\n            var active = length;\n            var remainingFirstValues = length;\n            var _loop_1 = function (i) {\n                maybeSchedule(scheduler, function () {\n                    var source = from_1.from(observables[i], scheduler);\n                    var hasFirstValue = false;\n                    source.subscribe(new OperatorSubscriber_1.OperatorSubscriber(subscriber, function (value) {\n                        values[i] = value;\n                        if (!hasFirstValue) {\n                            hasFirstValue = true;\n                            remainingFirstValues--;\n                        }\n                        if (!remainingFirstValues) {\n                            subscriber.next(valueTransform(values.slice()));\n                        }\n                    }, function () {\n                        if (!--active) {\n                            subscriber.complete();\n                        }\n                    }));\n                }, subscriber);\n            };\n            for (var i = 0; i < length; i++) {\n                _loop_1(i);\n            }\n        }, subscriber);\n    };\n}\nexports.combineLatestInit = combineLatestInit;\nfunction maybeSchedule(scheduler, execute, subscription) {\n    if (scheduler) {\n        executeSchedule_1.executeSchedule(subscription, scheduler, execute);\n    }\n    else {\n        execute();\n    }\n}\n//# sourceMappingURL=combineLatest.js.map"]},"metadata":{},"sourceType":"script"}