{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.connectable = void 0;\n\nvar Subject_1 = require(\"../Subject\");\n\nvar Observable_1 = require(\"../Observable\");\n\nvar defer_1 = require(\"./defer\");\n\nvar DEFAULT_CONFIG = {\n  connector: function () {\n    return new Subject_1.Subject();\n  },\n  resetOnDisconnect: true\n};\n\nfunction connectable(source, config) {\n  if (config === void 0) {\n    config = DEFAULT_CONFIG;\n  }\n\n  var connection = null;\n  var connector = config.connector,\n      _a = config.resetOnDisconnect,\n      resetOnDisconnect = _a === void 0 ? true : _a;\n  var subject = connector();\n  var result = new Observable_1.Observable(function (subscriber) {\n    return subject.subscribe(subscriber);\n  });\n\n  result.connect = function () {\n    if (!connection || connection.closed) {\n      connection = defer_1.defer(function () {\n        return source;\n      }).subscribe(subject);\n\n      if (resetOnDisconnect) {\n        connection.add(function () {\n          return subject = connector();\n        });\n      }\n    }\n\n    return connection;\n  };\n\n  return result;\n}\n\nexports.connectable = connectable;","map":{"version":3,"sources":["../../../../src/internal/observable/connectable.ts"],"names":[],"mappings":";;;;;;;AACA,IAAA,SAAA,GAAA,OAAA,CAAA,YAAA,CAAA;;AAEA,IAAA,YAAA,GAAA,OAAA,CAAA,eAAA,CAAA;;AACA,IAAA,OAAA,GAAA,OAAA,CAAA,SAAA,CAAA;;AAsBA,IAAM,cAAc,GAA+B;AACjD,EAAA,SAAS,EAAE,YAAA;AAAM,WAAA,IAAI,SAAA,CAAJ,OAAA,EAAA;AAAsB,GADU;AAEjD,EAAA,iBAAiB,EAAE;AAF8B,CAAnD;;AAaA,SAAgB,WAAhB,CAA+B,MAA/B,EAA2D,MAA3D,EAAwG;AAA7C,MAAA,MAAA,KAAA,KAAA,CAAA,EAAA;AAAA,IAAA,MAAA,GAAA,cAAA;AAA6C;;AAEtG,MAAI,UAAU,GAAwB,IAAtC;AACQ,MAAA,SAAS,GAA+B,MAAM,CAArC,SAAT;AAAA,MAAW,EAAA,GAA6B,MAAM,CAAX,iBAAnC;AAAA,MAAW,iBAAiB,GAAA,EAAA,KAAA,KAAA,CAAA,GAAG,IAAH,GAAO,EAAnC;AACR,MAAI,OAAO,GAAG,SAAS,EAAvB;AAEA,MAAM,MAAM,GAAQ,IAAI,YAAA,CAAA,UAAJ,CAAkB,UAAC,UAAD,EAAW;AAC/C,WAAO,OAAO,CAAC,SAAR,CAAkB,UAAlB,CAAP;AACD,GAFmB,CAApB;;AAOA,EAAA,MAAM,CAAC,OAAP,GAAiB,YAAA;AACf,QAAI,CAAC,UAAD,IAAe,UAAU,CAAC,MAA9B,EAAsC;AACpC,MAAA,UAAU,GAAG,OAAA,CAAA,KAAA,CAAM,YAAA;AAAM,eAAA,MAAA;AAAM,OAAlB,EAAoB,SAApB,CAA8B,OAA9B,CAAb;;AACA,UAAI,iBAAJ,EAAuB;AACrB,QAAA,UAAU,CAAC,GAAX,CAAe,YAAA;AAAM,iBAAC,OAAO,GAAG,SAAX,EAAA;AAAuB,SAA5C;AACD;AACF;;AACD,WAAO,UAAP;AACD,GARD;;AAUA,SAAO,MAAP;AACD;;AAxBD,OAAA,CAAA,WAAA,GAAA,WAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.connectable = void 0;\nvar Subject_1 = require(\"../Subject\");\nvar Observable_1 = require(\"../Observable\");\nvar defer_1 = require(\"./defer\");\nvar DEFAULT_CONFIG = {\n    connector: function () { return new Subject_1.Subject(); },\n    resetOnDisconnect: true,\n};\nfunction connectable(source, config) {\n    if (config === void 0) { config = DEFAULT_CONFIG; }\n    var connection = null;\n    var connector = config.connector, _a = config.resetOnDisconnect, resetOnDisconnect = _a === void 0 ? true : _a;\n    var subject = connector();\n    var result = new Observable_1.Observable(function (subscriber) {\n        return subject.subscribe(subscriber);\n    });\n    result.connect = function () {\n        if (!connection || connection.closed) {\n            connection = defer_1.defer(function () { return source; }).subscribe(subject);\n            if (resetOnDisconnect) {\n                connection.add(function () { return (subject = connector()); });\n            }\n        }\n        return connection;\n    };\n    return result;\n}\nexports.connectable = connectable;\n//# sourceMappingURL=connectable.js.map"]},"metadata":{},"sourceType":"script"}